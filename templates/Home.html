{% extends 'base.html' %}
{% load static %}
{% block title %}  {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<style>
    .calculator-container {
        max-width: 1200px;
        margin: 2rem auto;
        padding: 0 1rem 4rem 1rem;
        position: relative;
        z-index: 1;
    }
    
    .display-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4);
        padding: 2rem;
        margin-bottom: 2rem;
        backdrop-filter: blur(10px);
    }
    
    .display-label {
        color: rgba(255, 255, 255, 0.9);
        font-size: 0.875rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 0.5rem;
    }
    
    #equation-area {
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.3);
        color: white;
        font-size: 1.5rem;
        font-weight: 600;
        padding: 1rem;
        border-radius: 12px;
        min-height: 80px;
        resize: none;
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
    }
    
    #equation-area:focus {
        background: rgba(255, 255, 255, 0.2);
        border-color: rgba(255, 255, 255, 0.5);
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
    }
    
    #result-area {
        background: rgba(255, 255, 255, 0.25);
        border: 2px solid rgba(255, 255, 255, 0.4);
        color: white;
        font-size: 2rem;
        font-weight: 700;
        padding: 1rem;
        border-radius: 12px;
        min-height: 100px;
        resize: none;
        backdrop-filter: blur(10px);
    }
    
    .calc-btn {
        width: 65px;
        height: 65px;
        margin: 0.4rem;
        border: none;
        border-radius: 15px;
        font-size: 1.5rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.2s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    .calc-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }
    
    .calc-btn:active {
        transform: translateY(-1px);
    }
    
    .btn-number {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
    }
    
    .btn-operator {
        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        color: white;
    }
    
    .btn-function {
        background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        color: white;
    }
    
    .btn-calculate {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
        width: 100%;
        height: 65px;
        margin-top: 1rem;
        font-size: 1.25rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 2px;
    }
    
    .btn-calculate:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(56, 239, 125, 0.4);
    }
    
    .buttons-grid {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 0.3rem;
        justify-items: center;
    }
    
    .info-card {
        background: white;
        border-radius: 20px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        position: relative;
        z-index: 1;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: visible;
    }
    
    .info-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.12);
        z-index: 2;
    }
    
    .info-card h6 {
        color: #667eea;
        font-weight: 700;
        margin-bottom: 1rem;
        font-size: 1.1rem;
    }
    
    .tech-badge {
        display: inline-block;
        padding: 0.5rem 1rem;
        margin: 0.3rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 25px;
        font-size: 0.875rem;
        font-weight: 600;
        transition: all 0.2s ease;
        white-space: nowrap;
    }
    
    .tech-badge:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
    }
    
    .readme-text {
        line-height: 1.8;
        color: #555;
        font-size: 0.95rem;
    }
    
    .readme-text li {
        margin-bottom: 0.5rem;
    }
    
    @media (max-width: 768px) {
        .calc-btn {
            width: 55px;
            height: 55px;
            font-size: 1.25rem;
            margin: 0.25rem;
        }
        
        #equation-area, #result-area {
            font-size: 1.25rem;
        }
        
        .buttons-grid {
            gap: 0.2rem;
        }
        
        .info-card {
            margin-bottom: 2rem;
        }
        
        .calculator-container {
            padding-bottom: 2rem;
        }
    }
    
    @media (max-width: 992px) {
        .info-card {
            margin-bottom: 2rem;
        }
    }
    
    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }
    
    .calc-btn:focus {
        animation: pulse 0.3s ease;
    }
</style>
{% endblock stylesheets %}

{% block content %}

<div class="calculator-container">
    <!-- Display Area -->
    <div class="display-card">
        <div class="row">
            <div class="col-12 mb-3">
                <div class="display-label">üìù Equation</div>
                <textarea id="equation-area" class="form-control" rows="2" placeholder="Enter your equation..."></textarea>
            </div>
            <div class="col-12">
                <div class="display-label">= Result</div>
                <textarea id="result-area" class="form-control" rows="2" disabled placeholder="0"></textarea>
            </div>
        </div>
    </div>

    <!-- Calculator Buttons -->
    <div class="row g-3 mb-5">
        <div class="col-lg-5 col-md-12 mb-4">
            <div class="info-card">
                <div class="buttons-grid text-center">
                    <button class="calc-btn btn-number" data-value="7">7</button>
                    <button class="calc-btn btn-number" data-value="8">8</button>
                    <button class="calc-btn btn-number" data-value="9">9</button>
                    <button class="calc-btn btn-operator" data-value="/">√∑</button>
                    <button class="calc-btn btn-function" data-action="clear">C</button>
                    
                    <button class="calc-btn btn-number" data-value="4">4</button>
                    <button class="calc-btn btn-number" data-value="5">5</button>
                    <button class="calc-btn btn-number" data-value="6">6</button>
                    <button class="calc-btn btn-operator" data-value="*">√ó</button>
                    <button class="calc-btn btn-function" data-action="backspace">‚å´</button>
                    
                    <button class="calc-btn btn-number" data-value="1">1</button>
                    <button class="calc-btn btn-number" data-value="2">2</button>
                    <button class="calc-btn btn-number" data-value="3">3</button>
                    <button class="calc-btn btn-operator" data-value="-">‚àí</button>
                    <button class="calc-btn btn-operator" data-value="(">(</button>
                    
                    <button class="calc-btn btn-number" data-value="0">0</button>
                    <button class="calc-btn btn-number" data-value=".">.</button>
                    <button class="calc-btn btn-operator" data-value="=">=</button>
                    <button class="calc-btn btn-operator" data-value="+">+</button>
                    <button class="calc-btn btn-operator" data-value=")">)</button>
                </div>
                <button class="calc-btn btn-calculate" id="calculate-button">
                    üßÆ Calculate
                </button>
            </div>
        </div>


        <div class="col-lg-3 col-md-6 mb-4">
            <div class="info-card">
                <h6>üöÄ Tech Stack</h6>
                <div class="text-center">
                    <span class="tech-badge"><i class="fas fa-square-root-alt"></i> Django</span>
                    <span class="tech-badge"><i class="fas fa-code"></i> jQuery</span>
                    <span class="tech-badge"><i class="fas fa-palette"></i> SoftUI</span>
                    <span class="tech-badge"><i class="fab fa-bootstrap"></i> Bootstrap</span>
                    <span class="tech-badge"><i class="fas fa-database"></i> PostgreSQL</span>
                    <span class="tech-badge"><i class="fas fa-cloud"></i> MinIO</span>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="info-card">
                <h6>üìñ Features</h6>
                <ul class="readme-text" style="padding-left: 1.5rem;">
                    <li>‚ú® Beautiful modern UI with glassmorphism effects</li>
                    <li>‚å®Ô∏è Full keyboard support for faster calculations</li>
                    <li>üéØ Supports basic operations: +, ‚àí, √ó, √∑</li>
                    <li>üìê Parentheses for complex expressions</li>
                    <li>‚úÖ Real-time validation and error handling</li>
                    <li>üì± Fully responsive design</li>
                    <li>üé® Smooth animations and transitions</li>
                </ul>
            </div>
        </div>
    </div>
</div>

        <!--start of Modals-->
    <div class="modal fade " id="alertModal" tabindex="-1" aria-labelledby="alertModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content  bg-gradient">
            <div class="modal-header bg-gradient-info" >
              <h5 class="modal-title text-white" id="alertModalLabel">Alert</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <div class="alert alert-danger text-white font-weight-bold" role="alert" id="alert_modal_text">
                  A simple primary alert‚Äîcheck it out!
                </div>
            </div>
            <div class="modal-footer justify-content-center">
              <button type="button" class="btn bg-gradient-dark" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
        <!--end of Modals-->


</div>

{% endblock content %}

<!-- Specific JS goes HERE -->
{% block javascripts %}
    <script>
        $(document).ready(function() {
            // Handle button clicks
            $('.calc-btn[data-value]').click(function() {
                var value = $(this).data('value');
                var text = $('#equation-area').val();
                
                if (value === '=') {
                    calculateResult();
                } else {
                    $('#equation-area').val(text + value);
                    $('#equation-area').focus();
                }
            });
            
            // Handle function buttons
            $('.calc-btn[data-action]').click(function() {
                var action = $(this).data('action');
                
                if (action === 'clear') {
                    $('#equation-area').val('');
                    $('#result-area').val('');
                } else if (action === 'backspace') {
                    var text = $('#equation-area').val();
                    $('#equation-area').val(text.substring(0, text.length - 1));
                }
                $('#equation-area').focus();
            });
            
            // Calculate button
            $('#calculate-button').click(function() {
                calculateResult();
            });
            
            // Keyboard support
            $('#equation-area').keydown(function(e) {
                // Enter key to calculate
                if (e.which === 13) {
                    e.preventDefault();
                    calculateResult();
                }
                // Escape key to clear
                else if (e.which === 27) {
                    e.preventDefault();
                    $('#equation-area').val('');
                    $('#result-area').val('');
                }
            });
            
            // Calculate function
            function calculateResult() {
                var text = $('#equation-area').val();
                if (!text) {
                    showAlert('Please enter an equation', 'warning');
                    return;
                }
                
                $.ajax({
                    type: 'POST',
                    url: "{% url 'calculate' %}",
                    data: {
                        equation_string: text,
                        csrfmiddlewaretoken: '{{ csrf_token }}'
                    },
                    dataType: 'json',
                    success: function(data) {
                        $('#result-area').val(data.result);
                        if (data.message) {
                            showAlert(data.message, 'success');
                        }
                    },
                    error: function(xhr) {
                        try {
                            var response = JSON.parse(xhr.responseText);
                            showAlert(response.message || 'Calculation error', 'danger');
                        } catch(e) {
                            showAlert('An error occurred during calculation', 'danger');
                        }
                        $('#result-area').val('Error');
                    }
                });
            }
            
            // Show alert function
            function showAlert(message, type) {
                $('#alert_modal_text').text(message);
                $('#alert_modal_text').removeClass('alert-danger alert-warning alert-success alert-info');
                $('#alert_modal_text').addClass('alert-' + type);
                $("#alertModal").modal('show');
            }
            
            // Focus equation area on page load
            $('#equation-area').focus();
        });
    </script>
{% endblock javascripts %}
